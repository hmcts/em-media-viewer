<div class="jui-toolbar">
  <div class="mv-toolbar__container">
    <!-- The mvToolbarMain div contains all toolbar buttons except the "More options" button. This allows for calculation of the available space to display buttons -->
    <div id="mvToolbarMain" class="mv-toolbar-main" #mvToolbarMain>
      <ng-container *ngTemplateOutlet="menuItems"></ng-container>
    </div>
    <!-- The mvToolbarMoreOptions div contains the "More options" toolbar button (and the overlay template for the dropdown menu).
        The space occupied by the button (if visible) is excluded from the toolbar space available calculation -->
    <div id="mvToolbarMoreOptions" class="mv-toolbar-more-options">
      <button id="mvMoreOptionsBtn" class="jui-toolbar__button jui-toolbar__menu-button--more-options"
        [class.jui-toolbar__menu-button--more-options__hidden]="!toolbarHasHiddenButtons()" aria-pressed="false"
        (click)="isDropdownMenuOpen = !isDropdownMenuOpen" cdkOverlayOrigin #trigger="cdkOverlayOrigin">
        More options
      </button>
      <!-- This template displays the overlay content for the dropdown menu and is connected to the "More options" button -->
      <ng-template cdkConnectedOverlay [cdkConnectedOverlayOrigin]="trigger"
        [cdkConnectedOverlayOpen]="isDropdownMenuOpen" [cdkConnectedOverlayPositions]="dropdownMenuPositions">
        <div class="dropdown-menu" #dropdownMenu>
          <ng-container *ngTemplateOutlet="menuItems"></ng-container>
        </div>
      </ng-template>
    </div>
  </div>
</div>

<ng-template #menuItems>
  <button *ngIf="toolbarButtons.showSidebar" id="mvIndexBtn" title="Index" data-l10n-id="index"
    #mvIndexBtn class="jui-toolbar__button jui-toolbar__button--items"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvIndexBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvIndexBtn.id)" aria-pressed="false"
    (click)="toggleSideBar()">
    Index
  </button>

  <button *ngIf="toolbarButtons.showDrawButton" [disabled]="icpEnabled" id="mvDrawBtn" #mvDrawBtn class="jui-toolbar__button jui-toolbar__menu-button--draw" title="Draw a box"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvDrawBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvDrawBtn.id)"
    [class.toggled]="toolbarEvents.drawModeSubject | async" aria-pressed="false" data-l10n-id="toggleDrawButton"
    (click)="onClickDrawToggle()">
    <span data-l10n-id="draw_label">Draw a box</span>
  </button>

  <button *ngIf="toolbarButtons.showHighlightButton" [disabled]="icpEnabled" id="mvHighlightBtn" #mvHighlightBtn
    class="jui-toolbar__button jui-toolbar__menu-button--highlight" title="Highlight"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvHighlightBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvHighlightBtn.id)"
    [class.toggled]="toolbarEvents.highlightModeSubject | async" aria-pressed="false" (click)="onClickHighlightToggle()"
    data-l10n-id="toggleHighlightButton">
    <span data-l10n-id="highlight_label">Highlight</span>
  </button>

  <ng-container *ngIf="toolbarButtons.showNavigation">
    <div id="mvPageBtn" #mvPageBtn class="jui-toolbar__button jui-toolbar__menu-button--page" aria-pressed="false"
      [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvPageBtn.id)"
      [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvPageBtn.id)">
      Page
      <button id="mvUpBtn" role="button" [disabled]="pageNumber === 1" title="Previous Page"
        class="jui-toolbar__menu-button jui-toolbar__menu-button--up button-image" data-l10n-id="previous"
        (click)="decreasePageNumber()"></button>
      <button id="mvDownBtn" role="button" [disabled]="pageNumber === pageCount" title="Next Page"
        class="jui-toolbar__menu-button jui-toolbar__menu-button--down button-image" data-l10n-id="next"
        (click)="increasePageNumber()"></button>

      <input type="string" appInteger id="pageNumber" class="hmcts-toolbar-input govuk-input--width-2"
        title="Page Number" value="1" size="4" min="1" [value]="pageNumber" aria-label="page number" tabindex="0"
        data-l10n-id="page" (change)="onPageNumberInputChange(pageNumberInput.value)" #pageNumberInput>
      <span id="numPages" class="toolbarLabel">/ {{ pageCount }}</span>
    </div>
  </ng-container>

  <ng-container *ngIf="toolbarButtons.showZoom">
    <div id="mvZoomBtn" #mvZoomBtn class="jui-toolbar__button jui-toolbar__menu-button--zoom" aria-pressed="false"
      [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvZoomBtn.id)"
      [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvZoomBtn.id)">
      Zoom
      <button [disabled]="toolbarEvents.zoomValueSubject.value == 0.1" id="mvMinusBtn"
        class="jui-toolbar__menu-button jui-toolbar__menu-button--zoom-out button-image" title="Zoom Out"
        data-l10n-id="zoom_out" (click)="stepZoom(-0.1)"></button>
      <select id="scaleSelect" class="hmcts-toolbar-select" title="Zoom" tabindex="0" data-l10n-id="zoom"
        (change)="zoom($event.target.value)" aria-label="zoom">
        <option #zoomSelect id="customScaleOption" title="" [value]="toolbarEvents.zoomValueSubject.value">
          {{(toolbarEvents.zoomValueSubject.value) * 100 | number: '1.0-0'}}%</option>
        <option title="" value="0.1" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 10 }'>10%</option>
        <option title="" value="0.25" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 25 }'>25%</option>
        <option title="" value="0.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 50 }'>50%</option>
        <option title="" value="0.75" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 75 }'>75%</option>
        <option title="" value="1" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 100 }'>100%</option>
        <option title="" value="1.25" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 125 }'>125%</option>
        <option title="" value="1.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 150 }'>150%</option>
        <option title="" value="2.5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 250 }'>250%</option>
        <option title="" value="3" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 300 }'>300%</option>
        <option title="" value="5" data-l10n-id="page_scale_percent" data-l10n-args='{ "scale": 500 }'>500%</option>
      </select>

      <button [disabled]="toolbarEvents.zoomValueSubject.value == 5" id="mvPlusBtn"
        class="jui-toolbar__menu-button jui-toolbar__menu-button--zoom-in button-image" (click)="stepZoom(0.1)"
        title="Zoom In" data-l10n-id="zoom_in"></button>
    </div>
  </ng-container>

  <div *ngIf="toolbarButtons.showRotate" id="mvRotateBtn" #mvRotateBtn
    class="jui-toolbar__button jui-toolbar__menu-button--rotate" aria-pressed="false"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvRotateBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvRotateBtn.id)">
    <button id="mvRotateLeftBtn" class="jui-toolbar__menu-button jui-toolbar__menu-button--rotate_left button-image"
      title="Rotate Counterclockwise" data-l10n-id="page_rotate_ccw" (click)="rotate(-90)">
    </button>
    <button id="mvRotateRightBtn" class="jui-toolbar__menu-button jui-toolbar__menu-button--rotate_right button-image" title="Rotate Clockwise"
      data-l10n-id="page_rotate_cw" (click)="rotate(90)">
    </button>
    Rotate
  </div>

  <button *ngIf="toolbarButtons.showSearchBar" [disabled]="icpEnabled" id="mvSearchBtn" #mvSearchBtn title="Search"
    data-l10n-id="searchbar" class="jui-toolbar__button jui-toolbar__menu-button--search"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvSearchBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvSearchBtn.id)" aria-pressed="false"
    (click)="toggleSearchBar()">
    <span data-l10n-id="search_label">Search</span>
  </button>

  <button *ngIf="enableICP && toolbarButtons.showPresentationMode" [disabled]="icpEnabled || !icpSupported" id="mvPresentBtn" #mvPresentBtn
    class="jui-toolbar__button jui-toolbar__menu-button--present" title="In-Court Presentation Mode"
    data-l10n-id="icpMode_label" [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvPresentBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvPresentBtn.id)" aria-pressed="false"
    (click)="enterIcpMode()"><span data-l10n-id="icpMode_label">Present</span>
  </button>

  <button *ngIf="enableRedaction && toolbarButtons.showRedact" [disabled]="icpEnabled" id="mvRedactBtn" #mvRedactBtn title="Redact"
    data-l10n-id="redact" class="jui-toolbar__button jui-toolbar__menu-button--marker"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvRedactBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvRedactBtn.id)" aria-pressed="false"
    (click)="toggleRedactBar()">
    Redact
  </button>

  <button *ngIf="toolbarButtons.showGrabNDragButton" [disabled]="icpEnabled" id="mvGrabBtn" #mvGrabBtn class="jui-toolbar__button jui-toolbar__menu-button--grab"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvGrabBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvGrabBtn.id)" aria-pressed="false"
    (click)="toggleGrabNDrag()">
    Grab and drag
  </button>

  <button *ngIf="toolbarButtons.showDownload" [disabled]="icpEnabled" id="mvDownloadBtn" #mvDownloadBtn
    class="jui-toolbar__button jui-toolbar__menu-button--download" title="Download" data-l10n-id="download"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvDownloadBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvDownloadBtn.id)" aria-pressed="false"
    (click)="downloadFile()">
    Download
  </button>

  <button *ngIf="toolbarButtons.showPrint" [disabled]="icpEnabled" id="mvPrintBtn" #mvPrintBtn title="Print"
    data-l10n-id="print" class="jui-toolbar__button jui-toolbar__menu-button--printer"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvPrintBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvPrintBtn.id)" aria-pressed="false"
    (click)="printFile()">
    Print
  </button>

  <button *ngIf="enableAnnotations && toolbarButtons.showCommentSummary" [disabled]="icpEnabled" id="mvCommentsBtn" #mvCommentsBtn
    class="jui-toolbar__button jui-toolbar__menu-button--comments" title="Comments" data-l10n-id="comments"
    [class.button-hidden-on-toolbar]="!isToolbarButtonVisible(mvCommentsBtn.id)"
    [class.button-hidden-on-dropdown]="isToolbarButtonVisible(mvCommentsBtn.id)" aria-pressed="false"
    (click)="toggleCommentsPanel()">
    Comments
  </button>

  <!-- TODO: Where is this and how does it work?
  <ng-container *ngIf="!icpEnabled">
    <a *ngIf="toolbarButtons.showBookmark"
       href="#" id="viewBookmark" class="toolbarButton bookmark"
       title="Current view (copy or open in new window)" tabindex="0" data-l10n-id="bookmark">
      <span data-l10n-id="bookmark_label">Current View</span>
    </a>
  </ng-container>-->
</ng-template>